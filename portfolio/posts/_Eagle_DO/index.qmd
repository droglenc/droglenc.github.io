---
title: Eagle Lakes Thermocline
description: A depiction of temperature profiles for Eagle Lake that demonstrates the thermocline.
author: Derek H. Ogle
date: 2/6/2023
image: Eagle_Lake.jpg
categories:
  - Pike Chain
  - Limnology
  - Vis
knitr:
  opts_chunk:
    fig.width: 4
    fig.height: 4
format: 
  html:
    df-print: kable
---


```{r}
#| label: setup
library(tidyverse)
library(gganimate)
library(patchwork)

tp <- function(d,trng=NULL) {
  if (is.null(trng)) trng <- range(d$Temp)
  pt <- ggplot(data=d,mapping=aes(x=Temp,y=Depth,color=tWeek,group=DOY)) +
    geom_hline(aes(yintercept=0),linewidth=1,color="aquamarine") +
    geom_path(linewidth=1) +
    geom_point(pch=21,fill="white",size=1) +
    annotate(geom="rect",fill="slategray",
             xmin=40,xmax=trng[2],ymin=52,ymax=53) +
    scale_y_reverse(name="Depth (ft)",limits=c(NA,0),breaks=seq(0,50,10),
                    expand=expansion(mult=c(0,0.01))) +
    scale_x_continuous(name="Temperature (\u00b0F)",limits=c(40,NA),
                       expand=expansion(mult=0.01)) +
    scale_color_gradient2(low="blue3",
                          mid="red2",midpoint=11,
                          high="green3",guide="none") +
    theme_minimal() +
    theme(legend.position="none")
  pt
}

op <- function(d,orng=NULL,righty=FALSE) {
  if (is.null(orng)) orng <- range(d$DO)
  po <- ggplot(data=d,mapping=aes(x=DO,y=Depth,color=tWeek,group=DOY)) +
    geom_hline(aes(yintercept=0),linewidth=1,color="aquamarine") +
    geom_path(linewidth=1) +
    geom_point(pch=21,fill="white",size=1) +
    annotate(geom="rect",fill="slategray",
             xmin=0,xmax=orng[2],ymin=52,ymax=53) +
    scale_x_continuous(name="Dissolved Oxygen (mg/L)",limits=c(0,NA),
                       expand=expansion(mult=0.01)) +
    scale_color_gradient2(low="blue3",
                          mid="red2",midpoint=11,
                          high="green3",guide="none") +
    theme_minimal() +
    theme(legend.position="none",
          axis.title.y=element_blank())
  if (righty) {
    po <- po + 
      scale_y_reverse(name="Depth (ft)",limits=c(NA,0),breaks=seq(0,50,10),
                      expand=expansion(mult=c(0,0.01)),
                      position="right") +
      theme(axis.title.y=element_blank())
  } else {
    po <- po + 
      scale_y_reverse(name="Depth (ft)",limits=c(NA,0),breaks=seq(0,50,10),
                      expand=expansion(mult=c(0,0.01)))
  }
po
}
```

```{r}
#| label: data-prep
d <- readxl::read_excel("../_data/Pike_Chain_WQ_Data.xlsx",sheet="DO") |>
  filter(Lake=="Eagle Lake",!is.na(Temperature),!is.na(Depth)) |>
  mutate(Depth=ifelse(`Depth Units`=="FEET",Depth,Depth*3.280839895),
         Temperature=ifelse(`Temperature Units`=="DEGREES F",Temperature,
                            Temperature*1.8+32)) |>
  select(-contains("Units"),-Notes) |>
  rename(Date=`Start Date`,Temp=Temperature,DO=`Dissolved Oxygen`) |>
  mutate(Date=as.Date(Date,format="%m/%d/%Y"),
         Year=lubridate::year(Date),
         Month=lubridate::month(Date),
         Day=lubridate::day(Date),
         Week=lubridate::isoweek(Date),
         tWeek=Week-min(Week),
         DOY=lubridate::yday(Date),
         fDate=stringr::str_squish(format(Date,format="%b %e")))

d91 <- d |> filter(Year==1991)
d18 <- d |> filter(Year==2018)

trng <- range(d$Temp)
orng <- range(d$DO)
```

## Introduction
The Pike Chain of Lakes near Iron River, WI is a set of nine connected lakes, seven of which have relatively consistent water quality data. The Pike Chain is highly developed, has several public access locations, and is popular among anglers, boaters, snowmobilers, etc. year-round. Over the years, especially recently since [Eurasian watermilfoil](https://www.invasivespeciesinfo.gov/aquatic/plants/eurasian-watermilfoil) was introduced, volunteers have recorded various water quality parameters for the Pike Chain of lakes. Below I show the record of temperature by depth recordings that are publicly available through the [Wisconsin DNR Citizen Lake Monitoring Network](https://dnr.wisconsin.gov/topic/lakes/clmn).

&nbsp;

:::{.callout-warning icon=false}
# Summary

- XXX
:::

&nbsp;

## Temperature Profile Plot
A temperature profile plot shows the water temperature at various depths of measurement through the water column. Depth is shown with the water surface at the top and the lake bottom at the bottom of the *left* axis. Temperature increases from left to right on the *bottom* axis. The result shown in @fig-ex1991 is a typical mid-summer profile where the temperature is fairly and consistently warm near the surface (75-80<sup>o</sup>F from 0 to 15 ft) declines quickly over a fairly narrow depth range (drops from 75<sup>o</sup>F to 50<sup>o</sup>F from 15 to 30 ft) and then stays fairly and consistently cool at greater depths.

```{r}
#| label: fig-ex1991
#| fig-cap: !expr paste0('Temperature profile plot for ',format(d91$Date[1],format="%B %e, %Y"),'. The thin line at the top represents the water surface and the thicker line at the bottom represents the lake bottom.')
tp(d91)
```


```{r}
#| label: fig-ex1991a
#| fig-cap: !expr paste0('Temperature and dissolved oxygen profile plots for ',format(d91$Date[1],format="%B %e, %Y"),'. The thin line at the top represents the water surface and the thicker line at the bottom represents the lake bottom.')
tp(d91) + op(d91,right=TRUE)
```

&nbsp;

## Seasonal Changes in Temperature Profile
In winter (under the ice in northern Wisconsin) the water temperature will be a nearly constant 39<sup>o</sup>F from top to bottom (perhaps a little cooler at the ice-water interface). At ice-out the water temperature will still be fairly constant from top to bottom. However, as spring progresses the surface water becomes warmer and moving into summer that warmer water will extend deeper into the lake. However, in most lakes in our area there will be a depth where the water temperature begins to fall dramatically and will continue to fall over a fairly narrow depth range (see @fig-ex1991). Eventually there will be a depth where the water temperatures stays fairly and constantly cold below that depth. The transition zone from warmer surface to cooler below-surface water is called the *thermocline*. As fall approaches the process is reversed such that the surface water will cool (and, thus, sink) until the water temperature is again fairly constant throughout the water column.

On Eagle Lake we do not have water column temperature data very near the ice-out and ice-in dates. Thus, the seasonal phenomenon just described cannot be fully illustrated for Eagle Lake. However, @fig-ex2018 shows the general trend of warming and then cooling water near the surface through much of the open-water months.

```{r}
#| label: fig-ex2018
#| fig-cap: Temperature profile plots for six dates throughout the open-water season in 2018.
#| out-width: 50%
junk <- tp(d18) +
  transition_states(Date,wrap=FALSE) +
  labs(title='{format(as.Date(closest_state),"%B %e, %Y")}') +
  theme(plot.title=element_text(size=10)) +
  enter_fade() + exit_fade()
junk2 <- op(d18) +
  transition_states(Date,wrap=FALSE) +
  enter_fade() + exit_fade()
junk + junk2
```

&nbsp;

## Eagle Lake Temperature Profiles
```{r}
#| label: fig-ELTP
#| fig-cap: Temperature profiles for Eagle Lake separated by year (panels) and observation dates. Profile colors start with blue for early May transition through purple and pink to red for early July and then transition through orange and brown to green for late fall.
#| fig-height: 8
#| fig-width: 6
tp(d) +
  facet_wrap(vars(Year),ncol=3)
```

&nbsp;

## Resources

- [Temperature and Oxygen](https://www.nalms.org/secchidipin/monitoring-methods/temperature-and-oxygen/) at North American Lake Management Society
- [Dissolved Oxygen and Temperature](https://www.canr.msu.edu/michiganlakes/lake_ecology/dissolved_oxygen_and_temperature) at Michigan State U.
- [Vertical Mixing and Turnover](https://www.britannica.com/science/lake/Currents) at Britannica.com
- [Thermocline](https://www.boatsafe.com/thermocline/) at BoatSafe.com
